---
project:
  title: "ESS 330 Paper Proposals"
  output-dir: docs
  type: website
format:
  
  html:
    self-contained: true
authors:
  - name: Mia Colangelo
    affiliation: Colorado State University
    roles: writing
    corresponding: true
  - name: Neva Morgan
    affiliation: Colorado State University
    roles: writing
    corresponding: false
bibliography: references.bib
editor: 
  markdown: 
    wrap: 72
---

#### **Title:**

Flight in Flux: Analyzing American Bittern (Botaurus lentiginosus)
Migration Timing and Climate Change

**Introduction:** Climate change poses many questions relating to
systems across the globe, especially ecological and evolutionary
systems. One system which could potentially be heavily impacted is
migration. Bird migration timing is critical for ensuring species
survival and ecological balance. As anthropogenic climate change has
altered seasonal patterns, there is a potential disruption to migration
timing, impacting birds' breeding success, food availability, and
overall population health. The American Bittern (Botaurus lentiginosus),
for example, depends on the thriving vegetation of marshlands for
camouflage and nesting, as they are known to nest on the ground. Wetland
birds are expected to be affected negatively by a considerable margin
with the presence of a changing climate altering their regular migratory
ranges and patterns (Steen et al., 2012).

**Abstract/Background:** The American Bittern is a solitary, cryptic
species that relies on wetlands for breeding and overwintering.
Typically, these birds breed in freshwater marshes across Canada and the
northern United States before migrating south to the southeastern U.S.,
Mexico, and Central America for the winter. However, increasing global
temperatures, shifts in precipitation, and habitat loss due to climate
change threaten to disrupt these migration patterns. Past studies on
migratory birds indicate that climate change is leading to earlier
spring arrivals, delayed fall departures, and shifts in overall
migration routes (La Sorte & Thompson, 2007). For wetland-dependent
birds like the American Bittern, changes in water levels due to altered
precipitation cycles could further complicate their ability to find
suitable stopover sites and breeding grounds. Given that wetlands are
already among the most threatened ecosystems in North America, with
significant losses due to urbanization and agriculture, climate-induced
changes pose an additional challenge (Dahl, 2011). Studying the
migration patterns of the American Bittern under a changing climate is
essential for predicting future population trends and informing
conservation strategies. By understanding how climate variables
influence their movements, conservationists can prioritize habitat
protection, restoration, and adaptive management to mitigate potential
negative impacts.

**Sources:** American bittern overview, all about birds, Cornell Lab of
Ornithology. Overview, All About Birds, Cornell Lab of Ornithology.
(n.d.). https://www.allaboutbirds.org/guide/American_Bittern/overview

Dahl, T. E. (2011). Status and trends of wetlands in the conterminous
United States 2004 to 2009. US Department of the Interior, US Fish and
Wildlife Service, Fisheries and Habitat Conservation.

La Sorte, F. A., & Thompson III, F. R. (2007). Poleward shifts in winter
ranges of North American birds. Ecology, 88(7), 1803-1812.

**Motivation:** Bird migration range and timing is critical for ensuring
species survival and ecological balance. However, climate change has
altered seasonal patterns, potentially disrupting migration timing and
impacting breeding success, food availability, and overall population
health. Understanding these shifts can inform conservation strategies
and mitigate risks to migratory bird species. Additionally, information
gained from analyzing one species can be used to make inferences about
the potential shifts in other similar species.

**Data** American Bittern Migration: Steen, V., Powell, A. N. (2012).
"Potential Effects of Climate Change on the Distribution of Waterbirds
in the Prairie Pothole Region, U.S.A.," Waterbirds, 35(2), 217-229.
https://doi.org/10.1675/063.035.0204.

Beginning Mumbo Jumbo Libraries:
```{r}
library(readr)
library(flextable)
library(readr)
library(tidyverse)
library(tidymodels)
library(ggplot2)
library(purrr)
library(dplyr)
library(lubridate)
library(tidyr)
library(gridExtra)

```

**Methods**

1.  Create time period for seasons

```{r}
# Read in all climate data
AZ_kingman <- read_csv("data/Climate Data/AZ-kingman-climate.csv")


AZ_phoenix <- read_csv("data/Climate Data/AZ-phoenix-climate.csv")


CA_lake_tahoe <- read_csv("data/Climate Data/CA-lake-tahoe-climate.csv")


CA_sandiego <- read_csv("data/Climate Data/CA-sandiego-climate.csv")


CA_santarosa <- read_csv("data/Climate Data/CA-santarosa_climate.csv")


OR_chiloquin <- read_csv("data/Climate Data/OR-chiloquin-climate.csv")


OR_hermiston <- read_csv("data/Climate Data/OR-hermiston-climate.csv")


WA_shelton <- read_csv("data/Climate Data/WA-shelton-climate.csv")


WA_spokane <- read_csv("data/Climate Data/WA-spokane-climate.csv")


# Clarify joining values:

AZ_kingman$LATITUDE <- as.numeric(AZ_kingman$LATITUDE)
AZ_kingman$LONGITUDE <- as.numeric(AZ_kingman$LONGITUDE)

AZ_phoenix$LATITUDE <- as.numeric(AZ_phoenix$LATITUDE)
AZ_phoenix$LONGITUDE <- as.numeric(AZ_phoenix$LONGITUDE)

CA_lake_tahoe$LATITUDE <- as.numeric(CA_lake_tahoe$LATITUDE)
CA_lake_tahoe$LONGITUDE <- as.numeric(CA_lake_tahoe$LONGITUDE)

CA_sandiego$LATITUDE <- as.numeric(CA_sandiego$LATITUDE)
CA_sandiego$LONGITUDE <- as.numeric(CA_sandiego$LONGITUDE)

CA_santarosa$LATITUDE <- as.numeric(CA_santarosa$LATITUDE)
CA_santarosa$LONGITUDE <- as.numeric(CA_santarosa$LONGITUDE)

OR_chiloquin$LATITUDE <- as.numeric(OR_chiloquin$LATITUDE)
OR_chiloquin$LONGITUDE <- as.numeric(OR_chiloquin$LONGITUDE)

OR_hermiston$LATITUDE <- as.numeric(OR_hermiston$LATITUDE)
OR_hermiston$LONGITUDE <- as.numeric(OR_hermiston$LONGITUDE)

WA_shelton$LATITUDE <- as.numeric(WA_shelton$LATITUDE)
WA_shelton$LONGITUDE <- as.numeric(WA_shelton$LONGITUDE)

WA_spokane$LATITUDE <- as.numeric(WA_spokane$LATITUDE)
WA_spokane$LONGITUDE <- as.numeric(WA_spokane$LONGITUDE)


#Cleaning Data - the SAGA:

AZ_kingman <- AZ_kingman %>%
  select(-contains("ATTRIBUTES"))

AZ_phoenix <- AZ_phoenix %>%
  select(-contains("ATTRIBUTES"))

CA_lake_tahoe <- CA_lake_tahoe %>%
  select(-contains("ATTRIBUTES"))

CA_sandiego <- CA_sandiego %>%
  select(-contains("ATTRIBUTES"))

CA_santarosa <- CA_santarosa %>%
  select(-contains("ATTRIBUTES"))

OR_chiloquin <- OR_chiloquin %>%
  select(-contains("ATTRIBUTES"))

OR_hermiston <- OR_hermiston %>%
  select(-contains("ATTRIBUTES"))

WA_shelton <- WA_shelton %>%
  select(-contains("ATTRIBUTES"))

WA_spokane <- WA_spokane %>%
  select(-contains("ATTRIBUTES"))

#Adding to a collective list to make join easier!
station_list <- list(AZ_kingman, AZ_phoenix, CA_lake_tahoe, CA_sandiego, CA_santarosa, OR_chiloquin, OR_hermiston, WA_shelton, WA_spokane)


cleaned_list <- map(station_list, ~ select(.x, -contains("ATTRIBUTES")))


#Binding the cleaned data!
climate_data <- bind_rows(cleaned_list)

```

a. BUILDING SEASONS!:
```{r}

# Changing into month and year

head(climate_data$DATE)

climate_data <- climate_data %>%
  mutate(
    DATE = paste0(DATE, "-01"), # Adding a day component since it was missing!
    DATE = as.Date(DATE, format = "%Y-%m-%d"),
    year = year(DATE),
    month = month(DATE)
  )

# Creating a season:

climate_data <- climate_data %>%
  mutate(
    season = case_when(
      month %in% c(12, 1, 2)  ~ "Winter",
      month %in% c(3, 4, 5)   ~ "Spring",
      month %in% c(6, 7, 8)   ~ "Summer",
      month %in% c(9, 10, 11) ~ "Fall"
    ))



# Creating a season with the year to compare for climate
climate_data <- climate_data %>%
  mutate(
    season_year = if_else(month == 12, year + 1, year)
  )


#Separating temp and precp to clean further!

avg_temp <- climate_data %>%
  mutate(TAVG_F = (TAVG * 9/5) + 32) %>%
  group_by(STATION, NAME, month, season, season_year) %>%
  summarize(avg_temp = mean(TAVG_F, na.rm = TRUE), .groups = "drop") %>%
  filter(season_year >= 2000, season_year <= 2024)

avg_prec <- climate_data %>%
  group_by(STATION, NAME, month, season, season_year)%>%
  summarize(avg_prec = mean(PRCP, na.rm = TRUE), .groups = "drop") %>%
  filter(season_year >= 2000, season_year <= 2024)

```

2. Understanding the changes of average temperature and precipitation in a map!

a. Temperature Difference between 2000 - 2024 based on seasonality
```{r}
#TEMPERATURE!!!


#creating a separte coordination dataframe
station_coords <- climate_data %>%
  select(STATION, LATITUDE, LONGITUDE) %>%
  distinct()

#joining the two to relay to the map
avg_temp_map <- avg_temp %>%
  left_join(station_coords, by = "STATION")

#loading the u.s. map raster file!
us_map <- map_data("state")

#Creating map of avg temperature for Selected stations based on seasonality!

ggplot(avg_temp_map %>% filter(season_year >= 2000 & season_year <= 2024)) +
  geom_polygon(data = us_map, aes(x = long, y = lat, group = group),
               fill = "gray90", color = "white") +
  geom_point(aes(x = LONGITUDE, y = LATITUDE, color = avg_temp), size = 2) +
  scale_color_viridis_c(option = "plasma", name = "Avg Temp (°F)") +
  coord_fixed(1.3) +
  facet_wrap(~season) +
  labs(title = "Seasonal Average Temperatures by Station (2000–2024)",
       x = "", y = "") +
  theme_minimal()


# Let's compare first just what 2000 vs 2024 looks like!

# separating 2000 and 2024

avg_temp_2000 <- avg_temp_map %>% filter(season_year == 2000)
avg_temp_2024 <- avg_temp_map %>% filter(season_year == 2024)

# Create the ggplot for 2000
temp_2000 <- ggplot(avg_temp_2000) +
  geom_polygon(data = us_map, aes(x = long, y = lat, group = group),
               fill = "gray90", color = "white") +
  geom_point(aes(x = LONGITUDE, y = LATITUDE, color = avg_temp), size = 2) +
  scale_color_viridis_c(option = "plasma", name = "Avg. Temp. (°F)") +
  coord_fixed(1.3) +
  facet_wrap(~season) +
  labs(title = "Seasonal Average Temperatures (2000)",
       x = "", y = "") +
  theme_minimal()

# Create the ggplot for 2024
temp_2024 <- ggplot(avg_temp_2024) +
  geom_polygon(data = us_map, aes(x = long, y = lat, group = group),
               fill = "gray90", color = "white") +
  geom_point(aes(x = LONGITUDE, y = LATITUDE, color = avg_temp), size = 2) +
  scale_color_viridis_c(option = "plasma", name = "Avg. Temp. (°F)") +
  coord_fixed(1.3) +
  facet_wrap(~season) +
  labs(title = "Seasonal Average Temperatures (2024)",
       x = "", y = "") +
  theme_minimal()



# Arrange them to be side by side!


grid.arrange(temp_2000, temp_2024, ncol = 2)

```

b. Precipitation Difference between 2000 - 2024 based on seasonality

```{r}
#PRECIPITATION!!!

#joining the two to relay to the map
avg_prec_map <- avg_prec %>%
  left_join(station_coords, by = "STATION")

#Creating map of avg temperature for Selected stations based on seasonality!

ggplot(avg_prec_map %>% filter(season_year >= 2000 & season_year <= 2024)) +
  geom_polygon(data = us_map, aes(x = long, y = lat, group = group),
               fill = "gray90", color = "white") +
  geom_point(data = avg_prec_map %>%
               filter(season_year >= 2000 & season_year <= 2024),
             aes(x = LONGITUDE, y = LATITUDE, color = avg_prec), size = 2) +
  scale_color_viridis_c(option = "plasma", name = "Avg. Prec. (100 μm)") +
  coord_fixed(1.3) +
  facet_wrap(~season) +
  labs(title = "Seasonal Average Precipitation by Station (2000–2024)",
       x = "", y = "") +
  theme_minimal()


# Let's compare first just what 2000 vs 2024 looks like!

# separating 2000 and 2024

avg_prec_2000 <- avg_prec_map %>% filter(season_year == 2000)
avg_prec_2024 <- avg_prec_map %>% filter(season_year == 2024)

# Create the ggplot for 2000
prec_2000 <- ggplot(avg_prec_2000) +
  geom_polygon(data = us_map, aes(x = long, y = lat, group = group),
               fill = "gray90", color = "white") +
  geom_point(aes(x = LONGITUDE, y = LATITUDE, color = avg_prec), size = 2) +
  scale_color_viridis_c(option = "plasma", name = "Avg. Prec. (100 μm)") +
  coord_fixed(1.3) +
  facet_wrap(~season) +
  labs(title = "Seasonal Average Precipitation (2000)",
       x = "", y = "") +
  theme_minimal()

# Create the ggplot for 2024
prec_2024 <- ggplot(avg_prec_2024) +
  geom_polygon(data = us_map, aes(x = long, y = lat, group = group),
               fill = "gray90", color = "white") +
  geom_point(aes(x = LONGITUDE, y = LATITUDE, color = avg_prec), size = 2) +
  scale_color_viridis_c(option = "plasma", name = "Avg. Prec. (100 μm)") +
  coord_fixed(1.3) +
  facet_wrap(~season) +
  labs(title = "Seasonal Average Precipitation (2024)",
       x = "", y = "") +
  theme_minimal()



# Arrange them to be side by side!

grid.arrange(prec_2000, prec_2024, ncol = 2)


```

3. Bird migration pattern time!

Based on eBird data, we are focusing in the Western Pacific region of the U.S. (Arizona, California, Oregon, and Washington). Based on the eBird data set variables for understanding migratory codes:

```{r}
# read in bird data:

amebit_data <- read_csv("data/AB Data/amebit_data.csv")
View(amebit_data)
#I already precleaned it because of how much data there was for the American Bittern, so I don't have to clean it that much!


# Cleaning the Data to focus on what we want:

amebit_monthly <- amebit_data %>%
  mutate(ob_date = mdy(`OBSERVATION DATE`),
         year = year(ob_date),
         month = month(ob_date, label = TRUE)) %>%
  group_by(year, month) %>%
  summarize(observations = n(), .groups = "drop") %>%
  filter(year >= 2000, year <= 2024)




# Visualize time:

ggplot(amebit_monthly, aes(x = month, y = observations, group = year, color = as.factor(year))) +
  geom_line(alpha = 0.5) +
  labs(
    title = "Seasonal Observation Trends of American Bittern 2000 - 2024",
    x = "Month",
    y = "Number of Observations",
    color = "Year"
  ) +
  theme_minimal()


```



4. Looking at seasonal changes over time
```{r}

seasonal_summary <- climate_data %>%
  mutate(
    TAVG_F = (TAVG * 9/5) + 32,       # Convert temp to Fahrenheit
    PRCP_mm = PRCP / 10               # Convert tenths of mm to mm
  ) %>%
  group_by(season_year, season) %>%
  summarize(
    avg_temp = mean(TAVG_F, na.rm = TRUE),
    avg_precp = mean(PRCP_mm, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  filter(season_year >= 2000, season_year <= 2024)


# Reshaping to make plotting easier to understand shifts in Temp and Precip!

long_summary <- seasonal_summary %>%
  pivot_longer(cols = c(avg_temp, avg_precp),
               names_to = "variable", values_to = "value")


# Plotting:

ggplot(long_summary, aes(x = season_year, y = value, color = season)) +
  geom_line(size = 1) +
  facet_wrap(~ variable, scales = "free_y", 
             labeller = as_labeller(c(avg_temp = "Avg Temp (°F)", avg_precp = "Avg Precip (mm)"))) +
  labs(
    title = "Seasonal Trends in Temperature and Precipitation (2000–2024)",
    x = "Year", y = NULL
  ) +
  scale_color_brewer(palette = "Set2", name = "Season") +
  theme_minimal()

```


5. Let's combine them to see if there is a difference!

```{r}
# Adding seasonality to American Bittern data:

amebit_season <- amebit_monthly %>%
  mutate(season = case_when(
    month %in% c("Dec", "Jan", "Feb") ~ "Winter",
    month %in% c("Mar", "Apr", "May") ~ "Spring",
    month %in% c("Jun", "Jul", "Aug") ~ "Summer",
    month %in% c("Sep", "Oct", "Nov") ~ "Fall"
  )) %>%
  group_by(year, season) %>%
  summarize(total_obs = sum(observations), .groups = "drop")


# Merging the climate data and bittern data

combined_data <- left_join(amebit_season, seasonal_summary, 
                           by = c("year" = "season_year", "season"))


# Visualize climate and bittern data:

ggplot(combined_data, aes(x = avg_temp, y = total_obs, color = season)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(
    title = "Relationship Between Seasonal Temperature and Bittern Observations",
    x = "Average Temperature (°F)",
    y = "Bittern Observations"
  ) +
  scale_color_brewer(palette = "Set2") +
  theme_minimal()


# Relationship between climate and bittern evolving together!

combined_long <- combined_data %>%
  pivot_longer(cols = c(avg_temp, avg_precp, total_obs),
               names_to = "variable", values_to = "value")

ggplot(combined_long, aes(x = year, y = value, color = season)) +
  geom_line() +
  facet_wrap(~ variable, scales = "free_y",
             labeller = as_labeller(c(
               avg_temp = "Avg Temp (°F)",
               avg_precp = "Avg Precip (mm)",
               total_obs = "Bittern Observations"
             ))) +
  labs(
    title = "Bittern Observations and Climate Trends by Season (2000–2024)",
    x = "Year", y = NULL
  ) +
  scale_color_brewer(palette = "Set2") +
  theme_minimal()



```




